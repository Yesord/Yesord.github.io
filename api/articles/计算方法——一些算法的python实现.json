{"title":"计算方法——一些算法的python实现","uid":"c7f2a0b48c2c1da08799955658fe960e","slug":"计算方法——一些算法的python实现","date":"2023-11-20T16:14:56.000Z","updated":"2024-11-03T04:51:55.720Z","comments":true,"path":"api/articles/计算方法——一些算法的python实现.json","keywords":null,"cover":"https://s2.loli.net/2023/10/22/FivQZlT2kHXdEsu.jpg","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>本文是基于python实现的计算方法课程的算法，仅实数域内计算。<br>部分算法提供<strong>迭代曲线</strong>的绘制（基于matplotlib），可以在控制台打印每一步的迭代结果</p>\n<p><a href=\"https://github.com/Yesord/Calculate-Method\">GitHub库</a></p>\n<h1 id=\"Solution-for-Nonlinear-algebra-equation\"><a href=\"#Solution-for-Nonlinear-algebra-equation\" class=\"headerlink\" title=\"Solution_for_Nonlinear_algebra_equation\"></a>Solution_for_Nonlinear_algebra_equation</h1><h2 id=\"二分法\"><a href=\"#二分法\" class=\"headerlink\" title=\"二分法\"></a>二分法</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">math</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">matplotlib.pyplot</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># name: Dichotomy_method</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># function: 二分法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># parameter: f: 函数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            a: 区间左端点</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            b: 区间右端点</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            tol: 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            maxiter: 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            info: 是否输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            plot: 是否输出迭代曲线</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># return: x1: 迭代结果，如果无法判断是否有根则返回None</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#         epoch: 迭代次数，如果无法判断是否有根则返回None</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># date: 2023/11/21</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># author: Yesord</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># note 需要确定区间内有且仅有一个根</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Dichotomy_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">a,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">maxiter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=False,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=False</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span><span style=\"color: #BABED8\"> </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">a</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">f(a</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\"> f</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&gt;</span><span style=\"color: #BABED8\"> 0:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Error: f(&#123;&#125;) * f(&#123;&#125;) &gt; 0, we can&#39;t ensure that there is root in the interval [&#123;&#125;, &#123;&#125;]&quot;</span><span style=\"color: #FFCB6B\">.format(a,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">a,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b</span><span style=\"color: #BABED8\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\"># %操作符用于格式化字符串</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">None,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">None</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> epoch </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">maxiter</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> (a </span><span style=\"color: #C3E88D\">+</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b</span><span style=\"color: #BABED8\">) / 2</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">f(x1</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\"> f</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">a</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\"> 0:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        else:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">a</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">info:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;epoch = %d, x1 = %f&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">%</span><span style=\"color: #BABED8\"> (epoch, </span><span style=\"color: #C3E88D\">x1</span><span style=\"color: #BABED8\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:#</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">绘制迭代过程</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ion</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.xlabel</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">&quot;epoch&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.ylabel(</span><span style=\"color: #FFCB6B\">&quot;x&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.title(</span><span style=\"color: #FFCB6B\">&quot;Dichotomy method&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.plot(epoch_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">color=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">r</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">linestyle=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.pause(0.1</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">abs(x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\"> tol:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ioff</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.show</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_history.append(epoch</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x_history.append(x1</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Dichotomy_method_convergence_judgment</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">a,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">f(a</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\"> f</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&gt;</span><span style=\"color: #BABED8\"> 0:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Error: f(%f) * f(%f) &gt; 0, we can&#39;t ensure that there is root in the interval [%f, %f]&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">%</span><span style=\"color: #BABED8\"> (a, </span><span style=\"color: #C3E88D\">b,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">a,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b</span><span style=\"color: #BABED8\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\"># format()函数用于格式化字符串</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Dichotomy method isn&#39;t recommended.&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 测试</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">__name__</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">==</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">__main__</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># __name__是当前模块名，当模块被直接运行时模块名为__main__。没有被直接运行时模块名为文件名</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;\\n*****************************************************************&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Dichotomy method test start...&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;*****************************************************************\\n&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">f</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">y</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x</span><span style=\"color: #BABED8\">**</span><span style=\"color: #C3E88D\">2</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0.2</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">y</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">a</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-1</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">tol</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #C3E88D\">e-5</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">maxiter</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1000</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Dichotomy_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">a,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">maxiter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=True,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=True</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">x</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">is</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">None</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">or</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">is</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">None:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Dichotomy_method did not return valid values.&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    else:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;\\nx = %f, epoch = %d\\n&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">%</span><span style=\"color: #BABED8\"> (x, </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;\\n*****************************************************************&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Dichotomy method test end...&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;*****************************************************************\\n&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"></span></code></pre></div><h2 id=\"迭代法\"><a href=\"#迭代法\" class=\"headerlink\" title=\"迭代法\"></a>迭代法</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">math</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">matplotlib.pyplot</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># name: iterative_method</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># function: 迭代法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># parameter: g: 迭代函数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            x0: 初始值</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            tol: 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            maxiter: 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            info: 是否输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            plot: 是否输出迭代曲线</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># return: x1: 迭代结果</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#         epoch: 迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># date: 2023/11/21</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># author: Yesord</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># note 需要人工计算得到迭代函数以及验证是否收敛</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 迭代法</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">iterative_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">g,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">maxiter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=False,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=False</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> epoch </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">maxiter</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">g</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">info:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;epoch = %d, x1 = %f&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">%</span><span style=\"color: #BABED8\"> (epoch, </span><span style=\"color: #C3E88D\">x1</span><span style=\"color: #BABED8\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:#</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">绘制迭代过程</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ion</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.xlabel</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">&quot;epoch&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.ylabel(</span><span style=\"color: #FFCB6B\">&quot;x&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.title(</span><span style=\"color: #FFCB6B\">&quot;Iterative method&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.plot(epoch_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">color=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">r</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">linestyle=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.pause(0.1</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">abs(x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\"> tol:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ioff</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.show</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_history.append(epoch</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x_history.append(x1</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 测试</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">__name__</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">==</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">__main__</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">:</span><span style=\"color: #BABED8\"> </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;\\n*****************************************************************&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Iterative method test start...&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;*****************************************************************\\n&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">g</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 迭代函数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">y</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> (x**3 </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">2</span><span style=\"color: #BABED8\">*</span><span style=\"color: #C3E88D\">x</span><span style=\"color: #BABED8\">**</span><span style=\"color: #C3E88D\">2</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">+</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">3</span><span style=\"color: #BABED8\">*</span><span style=\"color: #C3E88D\">x</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #BABED8\">)/</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">3*x**2</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">4</span><span style=\"color: #BABED8\">*</span><span style=\"color: #C3E88D\">x</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">+</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">3</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">y</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">float</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">input(</span><span style=\"color: #FFCB6B\">&quot;Please input the initial value x0: &quot;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">tol</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #C3E88D\">e-5</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">maxiter</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1000</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">iterative_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">g,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">maxiter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=True,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=True</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;\\nx = %f, epoch = %d\\n&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">%</span><span style=\"color: #BABED8\"> (x, </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;*****************************************************************&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Iterative method test end...&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;*****************************************************************\\n&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span></span></code></pre></div><h2 id=\"牛顿法\"><a href=\"#牛顿法\" class=\"headerlink\" title=\"牛顿法\"></a>牛顿法</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">math</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">matplotlib.pyplot</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># name: Newton_method</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># function: 牛顿法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># parameter: f: 函数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            df: f的导函数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            x0: 初始值</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            tol: 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            maxiter: 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            info: 是否输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            plot: 是否输出迭代曲线</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># return: x1: 迭代结果</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#         epoch: 迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># date: 2023/11/21</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># author: Yesord</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># note 需要人工计算得到导函数以及验证是否收敛</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Newton_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">df,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">maxiter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=False,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=False</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">df</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">==</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">None:#</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">如果df没有定义，则使用数值微分</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">df</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">lambda</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x:</span><span style=\"color: #BABED8\"> (f(x+1e-6) - f</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x-1e-6</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">) / </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">2e-6</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># lambda x: df(f, x)是一个匿名函数，等价于def df(x): return df(f, x)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> epoch </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">maxiter</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">f</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">/df</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">info:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;epoch = %d, x1 = %f&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">%</span><span style=\"color: #BABED8\"> (epoch, </span><span style=\"color: #C3E88D\">x1</span><span style=\"color: #BABED8\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:#</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">绘制迭代过程</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ion</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.xlabel</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">&quot;epoch&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.ylabel(</span><span style=\"color: #FFCB6B\">&quot;x&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.title(</span><span style=\"color: #FFCB6B\">&quot;Newton method&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.plot(epoch_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">color=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">r</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">linestyle=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.pause(0.1</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">abs(x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\"> tol: </span><span style=\"color: #676E95; font-style: italic\"># 精度达到要求输出结果</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ioff</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.show</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_history.append(epoch</span><span style=\"color: #BABED8\">) </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x_history.append(x1</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 收敛性判断</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Newton_method_convergence_judgment</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">df,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">df(f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">) == 0:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Error: df(%f) = 0, Newton method isn&#39;t recommended.&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">%</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 测试</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">__name__</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">==</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">__main__</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">:</span><span style=\"color: #BABED8\"> </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">f</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">lambda</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">math.pow</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x,3</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">2</span><span style=\"color: #BABED8\">*</span><span style=\"color: #C3E88D\">math.pow</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x,2</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">+</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">3</span><span style=\"color: #BABED8\">*</span><span style=\"color: #C3E88D\">x</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">4</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># sample function</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">df</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">lambda</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x:</span><span style=\"color: #BABED8\"> (f(x+1e-6) - f</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x-1e-6</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">) / </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">2e-6</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># lambda f,x :用于定义匿名函数，冒号前面的x表示函数参数，冒号后面的x表示函数返回值</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;\\n*****************************************************************&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Newton method test start...&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;*****************************************************************\\n&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;test function: f(x) = x**3 - 2*x**2 + 3*x - 4&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#输出x0初值并将其转换成浮点数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">float</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">input(</span><span style=\"color: #FFCB6B\">&quot;Please input the initial value x0: &quot;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">) </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">tol</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #C3E88D\">e-6</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">maxiter</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">100</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Newton_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">df,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">maxiter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=True,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=True</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># Netwon method</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;x = %f, epoch = %d&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">%</span><span style=\"color: #BABED8\"> (x, </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">Newton_method_convergence_judgment(f,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">df,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 收敛性判断</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;\\n*****************************************************************&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;Newton method test done!&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;*****************************************************************\\n&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span></code></pre></div><h1 id=\"Iterative-method-for-Linear-algebra-equations\"><a href=\"#Iterative-method-for-Linear-algebra-equations\" class=\"headerlink\" title=\"Iterative_method_for_Linear_algebra_equations\"></a>Iterative_method_for_Linear_algebra_equations</h1><h2 id=\"雅可比迭代法\"><a href=\"#雅可比迭代法\" class=\"headerlink\" title=\"雅可比迭代法\"></a>雅可比迭代法</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">numpy</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">math</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">matplotlib.pyplot</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># jacobi迭代法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># name: jacobi_iterative_method</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># function: jacobi迭代法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># parameter: A: 系数矩阵</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            b: 常数项</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            x0: 初始值</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            tol: 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            max_iter: 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            info: 是否输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            plot: 是否输出迭代曲线</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># return: x1: 迭代结果</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#         epoch: 迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># date: 2023/11/20</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># author: Yesord</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">jacobi_iterative_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">max_iter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=False,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=False</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">len</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 方程组的阶数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.zeros</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 初始化x1</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x1_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x2_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x3_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_value</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> epoch </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">max_iter</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">: </span><span style=\"color: #676E95; font-style: italic\"># 迭代</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> i </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b[i]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> j </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">i</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">!=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">j:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 不是对角元素</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">A[i][j]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8\">*</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0[j]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">/=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">A[i][i]</span><span style=\"color: #BABED8\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">info:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;x^= &quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 输出结果</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;epoch= &quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代次数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代曲线</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1_history.append(x1[0]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x2_history.append(x1[1]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x3_history.append(x1[2]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">epoch_value.append(epoch</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ion</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 打开交互模式</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.xlabel</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">&quot;epoch&quot;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 设置x轴标签</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.ylabel(</span><span style=\"color: #FFCB6B\">&quot;x_iterative&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置y轴标签</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.title(</span><span style=\"color: #FFCB6B\">&quot;jacobi iterative method&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置标题</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">r.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x1图 r.-表示红色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x2,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x2_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">g.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x2图 g.-表示绿色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x3,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x3_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">b.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x3图 b.-表示蓝色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.pause(0.1</span><span style=\"color: #BABED8\">)   </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">np.linalg.norm(x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\"> tol: </span><span style=\"color: #676E95; font-style: italic\"># 判断是否满足精度要求</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x1.set_label(</span><span style=\"color: #FFCB6B\">&quot;x1&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置图例</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x2.set_label(</span><span style=\"color: #FFCB6B\">&quot;x2&quot;</span><span style=\"color: #BABED8\">) </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x3.set_label(</span><span style=\"color: #FFCB6B\">&quot;x3&quot;</span><span style=\"color: #BABED8\">) </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #82AAFF\">plt.legend</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 显示图例</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                plt.ioff</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 关闭交互模式</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #82AAFF\">plt.show</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 显示图像</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            break</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        x0 = x1.copy</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 更新x0</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 返回结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 测试</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">test</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [0, </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #C3E88D\">]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 初始值</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [[5, </span><span style=\"color: #C3E88D\">-2,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #C3E88D\">],</span><span style=\"color: #BABED8\"> [1, </span><span style=\"color: #F78C6C\">5</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-3</span><span style=\"color: #BABED8\">], </span><span style=\"color: #89DDFF\">[</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #BABED8\">, </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #BABED8\">, </span><span style=\"color: #F78C6C\">-5</span><span style=\"color: #89DDFF\">]</span><span style=\"color: #BABED8\">]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">B</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [4, </span><span style=\"color: #F78C6C\">2</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-11</span><span style=\"color: #BABED8\">] </span><span style=\"color: #676E95; font-style: italic\"># 常数项</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">tol</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0.5</span><span style=\"color: #C3E88D\">e-3</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">max_iter</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">100</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">jacobi_iterative_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">B,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">max_iter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=True,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=True</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># jacobi迭代法</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 返回结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span></span></code></pre></div><h2 id=\"高斯赛德尔迭代法\"><a href=\"#高斯赛德尔迭代法\" class=\"headerlink\" title=\"高斯赛德尔迭代法\"></a>高斯赛德尔迭代法</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">numpy</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">math</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">matplotlib.pyplot</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 高斯-赛德尔迭代法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># name: GS_iterative_method</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># function: 高斯-赛德尔迭代法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># parameter: A: 系数矩阵</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            b: 常数项</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            x0: 初始值</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            acurrate: 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            max_iter: 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            info: 是否输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            plot: 是否输出迭代曲线</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># return: x1: 迭代结果</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#         epoch: 迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># date: 2023/11/20</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># author: Yesord</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">GS_iterative_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">acurrate,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">max_iter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=False,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=False</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">len</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 方程组的阶数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x1_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x2_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x3_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_value</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.zeros</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 初始化x1</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> epoch </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">max_iter</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> i </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b[i]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> j </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">i</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">!=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">j:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">A[i][j]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8\">*</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1[j]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">/=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">A[i][i]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">info:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;x^= &quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 输出结果</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;epoch= &quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代次数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代曲线</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1_history.append(x1[0]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x2_history.append(x1[1]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x3_history.append(x1[2]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">epoch_value.append(epoch</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ion</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 打开交互模式</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.xlabel</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">&quot;epoch&quot;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 设置x轴标签</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.ylabel(</span><span style=\"color: #FFCB6B\">&quot;x_iterative&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置y轴标签</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.title(</span><span style=\"color: #FFCB6B\">&quot;GS iterative method&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置标题</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">r.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x1图 r.-表示红色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x2,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x2_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">g.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x2图 g.-表示绿色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x3,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x3_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">b.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x3图 b.-表示蓝色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.pause(0.1</span><span style=\"color: #BABED8\">)  </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">np.linalg.norm(x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\"> acurrate: </span><span style=\"color: #676E95; font-style: italic\"># 判断是否满足精度要求</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x1.set_label(</span><span style=\"color: #FFCB6B\">&quot;x1&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置图例</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x2.set_label(</span><span style=\"color: #FFCB6B\">&quot;x2&quot;</span><span style=\"color: #BABED8\">) </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x3.set_label(</span><span style=\"color: #FFCB6B\">&quot;x3&quot;</span><span style=\"color: #BABED8\">) </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #82AAFF\">plt.legend</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 显示图例</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                plt.ioff</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 关闭交互模式</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #82AAFF\">plt.show</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 显示图像</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            break</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        x0 = x1.copy</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 更新x0</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 返回结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 测试</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">test</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [0, </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #C3E88D\">]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 初始值</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [[5, </span><span style=\"color: #C3E88D\">-2,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #C3E88D\">],</span><span style=\"color: #BABED8\"> [1, </span><span style=\"color: #F78C6C\">5</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-3</span><span style=\"color: #BABED8\">], </span><span style=\"color: #89DDFF\">[</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #BABED8\">, </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #BABED8\">, </span><span style=\"color: #F78C6C\">-5</span><span style=\"color: #89DDFF\">]</span><span style=\"color: #BABED8\">] </span><span style=\"color: #676E95; font-style: italic\"># 系数矩阵</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">B</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [4, </span><span style=\"color: #F78C6C\">2</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-11</span><span style=\"color: #BABED8\">] </span><span style=\"color: #676E95; font-style: italic\"># 常数项</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">tol</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0.5</span><span style=\"color: #C3E88D\">e-3</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">max_iter</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">100</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">GS_iterative_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">B,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">max_iter,info=True,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=True</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># GS迭代法</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 返回结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span></code></pre></div><h2 id=\"SOC迭代法\"><a href=\"#SOC迭代法\" class=\"headerlink\" title=\"SOC迭代法\"></a>SOC迭代法</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">numpy</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">math</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">matplotlib.pyplot</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">as</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># SOC迭代法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># name: SOC_iterative_method</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># function: SOC迭代法</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># parameter: A: 系数矩阵</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            b: 常数项</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            x0: 初始值</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            w: 松弛因子</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            tol: 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            max_iter: 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            info: 是否输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#            plot: 是否输出迭代曲线,仅支持三元方程组</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># return: x1: 迭代结果</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#         epoch: 迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># date: 2023/11/20</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># author: Yesord</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">##############################################################################################################</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">SOC_iterative_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">w,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">max_iter,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">info=False,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=False</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">b</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.array</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 转换为numpy数组</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">len</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 方程组的阶数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">np.zeros</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 初始化x1</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">and</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">n</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">==</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">3</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x1_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x2_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">x3_history</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #FFCB6B\">epoch_value</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> []</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> epoch </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">max_iter</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">: </span><span style=\"color: #676E95; font-style: italic\"># 迭代</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> i </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">b[i]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> j </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">n</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">i</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">!=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">j:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 不是对角元素</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">A[i][j]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8\">*</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1[j]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">/=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">A[i][i]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1[i]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> (1 </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">w</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\"> x0</span><span style=\"color: #89DDFF\">[</span><span style=\"color: #BABED8\">i</span><span style=\"color: #89DDFF\">]</span><span style=\"color: #BABED8\"> + w </span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\"> x1</span><span style=\"color: #89DDFF\">[</span><span style=\"color: #BABED8\">i</span><span style=\"color: #89DDFF\">]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">info:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代信息</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;x^= &quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 输出结果</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #BABED8\">(</span><span style=\"color: #FFCB6B\">&quot;epoch= &quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代次数</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">and</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">n</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">==</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">3</span><span style=\"color: #C3E88D\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 输出迭代曲线</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x1_history.append(x1[0]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x2_history.append(x1[1]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">x3_history.append(x1[2]</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">epoch_value.append(epoch</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #82AAFF\">plt.ion</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 打开交互模式</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            plt.xlabel</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">&quot;epoch&quot;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 设置x轴标签</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.ylabel(</span><span style=\"color: #FFCB6B\">&quot;x_iterative&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置y轴标签</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.title(</span><span style=\"color: #FFCB6B\">&quot;SOC iterative method&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置标题</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">r.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x1图 r.-表示红色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x2,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x2_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">g.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x2图 g.-表示绿色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">line_x3,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plt.plot</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">epoch_value,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x3_history,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">b.-</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 画x3图 b.-表示蓝色点线图</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #FFCB6B\">plt.pause(0.1</span><span style=\"color: #BABED8\">)  </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">np.linalg.norm(x1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0</span><span style=\"color: #BABED8\">) </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\"> tol: </span><span style=\"color: #676E95; font-style: italic\"># 判断是否满足精度要求</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">plot:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x1.set_label(</span><span style=\"color: #FFCB6B\">&quot;x1&quot;</span><span style=\"color: #BABED8\">) </span><span style=\"color: #676E95; font-style: italic\"># 设置图例</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x2.set_label(</span><span style=\"color: #FFCB6B\">&quot;x2&quot;</span><span style=\"color: #BABED8\">) </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #FFCB6B\">line_x3.set_label(</span><span style=\"color: #FFCB6B\">&quot;x3&quot;</span><span style=\"color: #BABED8\">) </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #82AAFF\">plt.legend</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 显示图例</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                plt.ioff</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 关闭交互模式</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #82AAFF\">plt.show</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> # 显示图像</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            break</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        x0 = x1.copy</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 更新x0</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x1,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 返回结果</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># 测试</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">test</span><span style=\"color: #89DDFF\">()</span><span style=\"color: #C3E88D\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x0</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [0, </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #C3E88D\">]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 初始值</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">A</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [[4,3,0], </span><span style=\"color: #89DDFF\">[</span><span style=\"color: #F78C6C\">3</span><span style=\"color: #BABED8\">,4,-1</span><span style=\"color: #89DDFF\">]</span><span style=\"color: #BABED8\">, </span><span style=\"color: #89DDFF\">[</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #BABED8\">,-1,4</span><span style=\"color: #89DDFF\">]</span><span style=\"color: #BABED8\">] </span><span style=\"color: #676E95; font-style: italic\"># 系数矩阵</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">B</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> [16,20,-12] </span><span style=\"color: #676E95; font-style: italic\"># 常数项</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">w</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1.24</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 松弛因子</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">tol</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span><span style=\"color: #C3E88D\">e-3</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 精度要求</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">max_iter</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">100</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># 最大迭代次数</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">SOC_iterative_method</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">A,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">B,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x0,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">w,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">tol,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">max_iter,info=True,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">plot=True</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #676E95; font-style: italic\"># jacobi迭代法</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">x,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">epoch</span></span>\n<span class=\"line\"></span></code></pre></div>","text":"前言本文是基于python实现的计算方法课程的算法，仅实数域内计算。部分算法提供迭代曲线的绘制（基于matplotlib），可以在控制台打印每一步的迭代结果 G...","permalink":"/post/计算方法——一些算法的python实现","photos":[],"count_time":{"symbolsCount":"17k","symbolsTime":"15 mins."},"categories":[],"tags":[{"name":"python","slug":"python","count":5,"path":"api/tags/python.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Solution-for-Nonlinear-algebra-equation\"><span class=\"toc-text\">Solution_for_Nonlinear_algebra_equation</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E5%88%86%E6%B3%95\"><span class=\"toc-text\">二分法</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%BF%AD%E4%BB%A3%E6%B3%95\"><span class=\"toc-text\">迭代法</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%89%9B%E9%A1%BF%E6%B3%95\"><span class=\"toc-text\">牛顿法</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Iterative-method-for-Linear-algebra-equations\"><span class=\"toc-text\">Iterative_method_for_Linear_algebra_equations</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%9B%85%E5%8F%AF%E6%AF%94%E8%BF%AD%E4%BB%A3%E6%B3%95\"><span class=\"toc-text\">雅可比迭代法</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%AB%98%E6%96%AF%E8%B5%9B%E5%BE%B7%E5%B0%94%E8%BF%AD%E4%BB%A3%E6%B3%95\"><span class=\"toc-text\">高斯赛德尔迭代法</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#SOC%E8%BF%AD%E4%BB%A3%E6%B3%95\"><span class=\"toc-text\">SOC迭代法</span></a></li></ol></li></ol>","author":{"name":"Yesord","slug":"blog-author","avatar":"https://s2.loli.net/2023/10/17/4GK2m3UkXztog9D.jpg","link":"/","description":"猫军阀军校的一个三年级学牲。","socials":{"github":"https://github.com/Yesord","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/aoliba_believer","juejin":"","customs":{"Home":{"icon":"/img/Home.svg","link":"https://home.yesord.top/about/"},"Academic":{"icon":"/img/Academic.svg","link":"https://academic.yesord.top"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"基于pytorch的简单BP神经网络搭建","uid":"150ed4b39e17f0239763704a3281f203","slug":"基于pytorch的简单BP神经网络搭建","date":"2023-11-21T15:56:50.000Z","updated":"2024-11-03T04:51:55.716Z","comments":true,"path":"api/articles/基于pytorch的简单BP神经网络搭建.json","keywords":null,"cover":"https://s2.loli.net/2023/11/22/dUzaVA5PKlTWhbN.png","text":"前言神经网络(个人理解)神经网络本质就是权重，就是计算机在那算数，计算你输入的值经过网络迭代后得到另一个值，就很像函数对应一样，但是能进行推理，输入定义域以外的...","permalink":"/post/基于pytorch的简单BP神经网络搭建","photos":[],"count_time":{"symbolsCount":"6.4k","symbolsTime":"6 mins."},"categories":[{"name":"AI","slug":"AI","count":3,"path":"api/categories/AI.json"}],"tags":[{"name":"ANN","slug":"ANN","count":1,"path":"api/tags/ANN.json"}],"author":{"name":"Yesord","slug":"blog-author","avatar":"https://s2.loli.net/2023/10/17/4GK2m3UkXztog9D.jpg","link":"/","description":"猫军阀军校的一个三年级学牲。","socials":{"github":"https://github.com/Yesord","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/aoliba_believer","juejin":"","customs":{"Home":{"icon":"/img/Home.svg","link":"https://home.yesord.top/about/"},"Academic":{"icon":"/img/Academic.svg","link":"https://academic.yesord.top"}}}}},"next_post":{"title":"pytorch环境搭建下遇到的问题","uid":"a6d09d63bbb6828b08c842fdfa1f3e69","slug":"pytorch环境搭建下遇到的问题","date":"2023-11-15T13:53:53.000Z","updated":"2024-11-03T04:51:55.711Z","comments":true,"path":"api/articles/pytorch环境搭建下遇到的问题.json","keywords":null,"cover":"https://s2.loli.net/2023/10/22/Scg4WKwdb72nfFu.jpg","text":"前言总所周知，ai的发展是极度迅速的，ai相关的软件与库的更新速度极快，很容易出现库依赖之间的不兼容，因而基于anaconda下的pytorch环境搭建总是会遇...","permalink":"/post/pytorch环境搭建下遇到的问题","photos":[],"count_time":{"symbolsCount":226,"symbolsTime":"1 mins."},"categories":[{"name":"AI","slug":"AI","count":3,"path":"api/categories/AI.json"}],"tags":[{"name":"ComputerVision","slug":"ComputerVision","count":3,"path":"api/tags/ComputerVision.json"}],"author":{"name":"Yesord","slug":"blog-author","avatar":"https://s2.loli.net/2023/10/17/4GK2m3UkXztog9D.jpg","link":"/","description":"猫军阀军校的一个三年级学牲。","socials":{"github":"https://github.com/Yesord","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/aoliba_believer","juejin":"","customs":{"Home":{"icon":"/img/Home.svg","link":"https://home.yesord.top/about/"},"Academic":{"icon":"/img/Academic.svg","link":"https://academic.yesord.top"}}}}}}