{"title":"深度学习细胞虚拟染色研究","uid":"7334b3419d5caf6520825251532abbd2","slug":"深度学习细胞虚拟染色研究","date":"2025-10-02T09:06:57.000Z","updated":"2025-10-02T15:03:12.121Z","comments":true,"path":"api/articles/深度学习细胞虚拟染色研究.json","keywords":null,"cover":"https://imgbed.yesord.top/file/cover/1758794562104_GK4GpkrbUAAW2vE.jpg","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>这是我</p>\n<h1 id=\"目标\"><a href=\"#目标\" class=\"headerlink\" title=\"目标\"></a>目标</h1><p>利用所提供的不成对的数据集（即输入和输出图像并不是完全对称）以及深度学习技术对血细胞虚拟染色。实现从黑白图像（灰度图像）到RGB彩色图像的迁移。</p>\n<details class=\"custom-details\">\n<summary>数据集</summary>\n<p>数据集下载（百度网盘）：<br>链接: <a href=\"https://pan.baidu.com/s/1WUaljE6WreB_6TvWlPrzGQ\">https://pan.baidu.com/s/1WUaljE6WreB_6TvWlPrzGQ</a><br>提取码: m9ek</p>\n\n</details>\n<h1 id=\"实现过程\"><a href=\"#实现过程\" class=\"headerlink\" title=\"实现过程\"></a>实现过程</h1><h2 id=\"前期调研\"><a href=\"#前期调研\" class=\"headerlink\" title=\"前期调研\"></a>前期调研</h2><p>项目需要去完成风格迁移的任务去完成细胞染色，而项目已经提供现成的使用CycleGAN的方案，风格迁移可以使用很多模型例如 UGATIT StarGANv2之类考虑到数据集不对称等最终还是选择了最成熟的CycleGAN。完成去噪通过传统的open CV方案是最省事最快速的，但是后续的调参过程很繁琐且扩展性不够，因此选择使用去噪模型进行图像数据的预处理。以前使用过DeblurNetv2做过去噪，但是效果一般部署起来也麻烦。通过在GitHub的寻找也找到了合适的模型NAFNet——2022年的SOTA。</p>\n<p>本次实验我采用NAFNet与CycleGAN复合的方法来进行细胞虚拟染色的处理，流程分为4个部分<br>1）数据集生成<br>2）数据预处理<br>3）CycleGAN模型训练<br>4）细胞上色</p>\n<h2 id=\"项目依赖\"><a href=\"#项目依赖\" class=\"headerlink\" title=\"项目依赖\"></a>项目依赖</h2><p>详见CycleGAN GitHub仓库<br>详见NAFNet GitHub仓库</p>\n<h3 id=\"数据集生成\"><a href=\"#数据集生成\" class=\"headerlink\" title=\"数据集生成\"></a>数据集生成</h3><p>首先，提供的实验数据总共约720张（350灰度+350RGB），对于模型训练来说数据集相对偏小，最好进行数据集的扩增。将原始包含350张灰度图像的训练集通过数据增强技术扩增至1750张（实现5倍扩增）。在数据集构建思路上，针对不同图像类型设置差异化处理策略：仅对灰度图像开展噪声处理时，高斯噪声的归一化标准差范围设定为0.02 - 0.05，散粒噪声（泊松噪声）作用于15% - 30%的像素值；对于灰度与RGB图像的同步处理场景，采用幅度为-2%<del>2%的缩放、-6%</del>6%的旋转以及最高1px的模糊等变换操作，且上述处理过程以50%的随机概率执行。数据集划分阶段，按照8:1:1的比例分别确定训练集、验证集与测试集的样本量。此外，基于CycleGAN数据集不成对的特性，将数据集划分为trainA和trainB两部分，以满足模型训练过程中对不同域数据的适配需求</p>\n<div align=center>\n    <img src=\"https://imgbed.yesord.top/file/blog/1759409825283_图片3.png\">\n</div>\n<div align=center>部分CycleGAN的增强数据集展示</div>\n\n\n<p>虽然没有时间进行去噪模型的训练，但是我也准备好了去噪模型的数据集<br>针对NAFNet模型开展数据集构建工作，将初始包含350张灰度图的训练集通过数据增广技术扩展为1750张。数据增广的构建思路涵盖多种噪声与模糊扰动：引入归一化标准差范围为0.02 - 0.05的高斯噪声，添加占比15% - 30%像素值的散粒噪声（泊松噪声），施加模糊半径在1 - 3px间的运动模糊，且上述扰动以50%的随机概率应用；数据集按照7:2:1的比例划分为训练集、验证集与测试集，同时遵循NAFNet“数据集必须一一对应”的特性，将生成的含噪声数据作为模型输入（input），原始无噪声数据作为目标输出（target），以此完成适配NAFNet训练需求的数据集构建。</p>\n<div align=center>\n    <img src=\"https://imgbed.yesord.top/file/blog/1759409821536_图片4.png\">\n</div>\n<div align=center>部分NAFNet的增强数据集展示</div>\n\n<h3 id=\"数据预处理\"><a href=\"#数据预处理\" class=\"headerlink\" title=\"数据预处理\"></a>数据预处理</h3><p>采用NAFNet对含噪或模糊的输入图像进行处理。先在Google Colab上进行简单测试，看模型的性能。从可视化结果来看，输入图像存在的噪声与模糊问题在经NAFNet处理后得到明显改善，输出图像在细节保留与清晰度提升方面表现优异；同时，通过重建质量分析可知，该模型处理后图像的平均结构相似性（SSIM）达到0.867，平均峰值信噪比（PSNR）为29.09 dB，定量指标也验证了NAFNet在图像去噪去模糊任务中能够有效提升图像质量，展现出良好的重建能力与去噪去模糊性能。</p>\n<div align=center>\n    <img src=\"https://imgbed.yesord.top/file/blog/1759409816924_图片5.png\">\n</div>\n<div align=center>自制数据集去噪效果</div>\n\n<div align=center>\n    <img src=\"https://imgbed.yesord.top/file/blog/1759409820605_图片6.png\">\n</div>\n<div align=center>原数据集去噪效果</div>\n\n\n<h3 id=\"模型训练\"><a href=\"#模型训练\" class=\"headerlink\" title=\"模型训练\"></a>模型训练</h3><p>在CycleGAN的训练实验中，采用细胞染色数据集（Cell Staining Dataset）开展训练，设置默认参数并训练200个epoch。从训练损失可视化结果来看，模型收敛性良好，循环一致性约束在训练过程中效果显著；不过生成器与判别器的博弈平衡性存在不足，其中A→B方向的判别器Dₐ损失过低，疑似判别器过强，而对应的生成器Gₐ损失偏高，该情况可能对生成质量造成限制。</p>\n<div align=center>\n    <img src=\"https://imgbed.yesord.top/file/blog/1759409817445_图片7.png\">\n</div>\n<div align=center>CycleGAN训练效果</div>\n\n\n<h3 id=\"回归预测\"><a href=\"#回归预测\" class=\"headerlink\" title=\"回归预测\"></a>回归预测</h3><p>在CycleGAN训练效果的实验中，针对血细胞灰度图虚拟染色的任务，模型呈现出特定的性能表现。从生成结果的可视化来看，输入的血细胞灰度图经CycleGAN处理后，可转换为具有染色特征的图像；其中不同样本的重建质量存在差异，对应“重建质量分析”指标显示，部分案例平均SSIM分别为0.561、0.749、0.987，平均PSNR分别达到17.43 dB、18.05 dB、39.41 dB，这些量化结果反映了生成图像与目标染色图像在结构相似性与峰值信噪比层面的匹配程度。整体而言，该模型能够实现血细胞灰度图的虚拟染色，但在泛化能力方面存在不足，当输入为含噪声的血细胞灰度图时，其生成染色图像的质量较差。</p>\n<div align=center>\n    <img src=\"https://imgbed.yesord.top/file/blog/1759409818140_图片8.png\">\n</div>\n<div align=center>degraded 图像染色</div>\n\n<div align=center>\n    <img src=\"https://imgbed.yesord.top/file/blog/1759409818140_图片8.png\">\n</div>\n<div align=center>noisy 图像染色</div>\n\n<div align=center>\n    <img src=\"https://imgbed.yesord.top/file/blog/1759409818140_图片8.png\">\n</div>\n<div align=center>normal图像染色</div>\n\n<h1 id=\"参考网址\"><a href=\"#参考网址\" class=\"headerlink\" title=\"参考网址\"></a>参考网址</h1><p><a href=\"https://github.com/nightrome/really-awesome-gan\">https://github.com/nightrome/really-awesome-gan</a><br><a href=\"https://github.com/subeeshvasu/Awesome-Deblurring\">https://github.com/subeeshvasu/Awesome-Deblurring</a><br><a href=\"https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix\">https://github.com/junyanz/pytorch-CycleGAN-and-pix2pix</a><br><a href=\"https://github.com/megvii-research/NAFNet\">https://github.com/megvii-research/NAFNet</a><br><a href=\"https://blog.csdn.net/weixin_46235765/article/details/119026209\">https://blog.csdn.net/weixin_46235765&#x2F;article&#x2F;details&#x2F;119026209</a><br><a href=\"https://blog.csdn.net/weixin_44523062/article/details/105631328\">https://blog.csdn.net/weixin_44523062&#x2F;article&#x2F;details&#x2F;105631328</a><br><a href=\"https://blog.csdn.net/frothmoon/article/details/90341693\">https://blog.csdn.net/frothmoon/article/details/90341693</a><br><a href=\"https://blog.csdn.net/qq_40280673/article/details/125921937\">https://blog.csdn.net/qq_40280673&#x2F;article&#x2F;details&#x2F;125921937</a><br><a href=\"https://blog.csdn.net/qq_24224067/article/details/104538137\">https://blog.csdn.net/qq_24224067&#x2F;article&#x2F;details&#x2F;104538137</a><br><a href=\"https://zhuanlan.zhihu.com/p/521264492\">https://zhuanlan.zhihu.com/p/521264492</a><br><a href=\"https://blog.csdn.net/qq_45368632/article/details/131769856\">https://blog.csdn.net/qq_45368632&#x2F;article&#x2F;details&#x2F;131769856</a></p>\n","text":"前言这是我 目标利用所提供的不成对的数据集（即输入和输出图像并不是完全对称）以及深度学习技术对血细胞虚拟染色。实现从黑白图像（灰度图像）到RGB彩色图像的迁移。...","permalink":"/post/深度学习细胞虚拟染色研究","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"DeepLearning","slug":"DeepLearning","count":1,"path":"api/categories/DeepLearning.json"}],"tags":[{"name":"ComputerVision","slug":"ComputerVision","count":4,"path":"api/tags/ComputerVision.json"},{"name":"python","slug":"python","count":6,"path":"api/tags/python.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%9B%AE%E6%A0%87\"><span class=\"toc-text\">目标</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B\"><span class=\"toc-text\">实现过程</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%89%8D%E6%9C%9F%E8%B0%83%E7%A0%94\"><span class=\"toc-text\">前期调研</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%A1%B9%E7%9B%AE%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\">项目依赖</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E9%9B%86%E7%94%9F%E6%88%90\"><span class=\"toc-text\">数据集生成</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86\"><span class=\"toc-text\">数据预处理</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83\"><span class=\"toc-text\">模型训练</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9B%9E%E5%BD%92%E9%A2%84%E6%B5%8B\"><span class=\"toc-text\">回归预测</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%82%E8%80%83%E7%BD%91%E5%9D%80\"><span class=\"toc-text\">参考网址</span></a></li></ol>","author":{"name":"Yesord","slug":"blog-author","avatar":"/img/avatar/Flametail.gif","link":"/","description":"猫军阀军校的一个四年级学牲。","socials":{"github":"https://github.com/Yesord","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/aoliba_believer","juejin":"","customs":{"Home":{"icon":"/img/Home.svg","link":"https://home.yesord.top/about/"},"Academic":{"icon":"/img/Academic.svg","link":"https://academic.yesord.top"},"Travelling":{"icon":"/img/train.svg","link":"https://www.travellings.cn/go.html"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"Office破解方法","uid":"8ef1d34961ad10ae08a2490597961436","slug":"Office破解方法","date":"2025-10-09T02:04:26.000Z","updated":"2025-10-09T03:12:33.793Z","comments":true,"path":"api/articles/Office破解方法.json","keywords":null,"cover":"https://imgbed.yesord.top/file/cover/1759977414392_EKRd7sbVAAMSLrV.png","text":"前言今天重装了家里的电脑的系统，遇到挺多屁事，例如网卡驱动没装上不了网但上不了网没法下载网卡驱动之类的，但正好也重装了 Office 因此我在这里想记录一下我的...","permalink":"/post/Office破解方法","photos":[],"count_time":{"symbolsCount":163,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"solution","slug":"solution","count":3,"path":"api/tags/solution.json"}],"author":{"name":"Yesord","slug":"blog-author","avatar":"/img/avatar/Flametail.gif","link":"/","description":"猫军阀军校的一个四年级学牲。","socials":{"github":"https://github.com/Yesord","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/aoliba_believer","juejin":"","customs":{"Home":{"icon":"/img/Home.svg","link":"https://home.yesord.top/about/"},"Academic":{"icon":"/img/Academic.svg","link":"https://academic.yesord.top"},"Travelling":{"icon":"/img/train.svg","link":"https://www.travellings.cn/go.html"}}}}},"next_post":{"title":"ROS2 桥接 MQTT 服务器与 Web 通信","uid":"4e143a87dfacf185ad49d19d39f24dfc","slug":"ROS2桥接MQTT服务器与Web通信","date":"2025-07-17T08:43:02.000Z","updated":"2025-09-22T08:16:47.588Z","comments":true,"path":"api/articles/ROS2桥接MQTT服务器与Web通信.json","keywords":null,"cover":"https://imgbed.yesord.top/file/cover/1752742170585_132547500_p0_master1200.jpg","text":"前言最近在前海实习的过程，初学 ROS2，项目经理给到业务要做产品的展示，需要将在综保区的ROS自动驾驶车的数据回传到网页进行显示，通过调研可以使用 MQTT ...","permalink":"/post/ROS2桥接MQTT服务器与Web通信","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[],"tags":[{"name":"ROS","slug":"ROS","count":1,"path":"api/tags/ROS.json"}],"author":{"name":"Yesord","slug":"blog-author","avatar":"/img/avatar/Flametail.gif","link":"/","description":"猫军阀军校的一个四年级学牲。","socials":{"github":"https://github.com/Yesord","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/aoliba_believer","juejin":"","customs":{"Home":{"icon":"/img/Home.svg","link":"https://home.yesord.top/about/"},"Academic":{"icon":"/img/Academic.svg","link":"https://academic.yesord.top"},"Travelling":{"icon":"/img/train.svg","link":"https://www.travellings.cn/go.html"}}}}}}